generator client {
  provider = "prisma-client"
  output   = "../generated"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  
}

model Usuario {
  id                 Int            @id @default(autoincrement())
  nome               String         @db.VarChar(100)
  username           String         @db.VarChar(30) @unique
  senha              String         @db.VarChar(255)
  
  cep                String   @db.VarChar(8)
  logradouro         String   @db.VarChar(100)
  numero             String   @db.VarChar(10)  
  complemento        String?  @db.VarChar(100) 
  bairro             String   @db.VarChar(100)
  cidade             String   @db.VarChar(100)
  estado            String    @db.VarChar(100)

  anuncios           Anuncio[]

  @@map("usuario")
}


model Categoria {
  id       Int     @id @default(autoincrement())
  nome     String  @db.VarChar(100) @unique 
  tipo     TipoAnuncio
  
  anuncios Anuncio[]

  @@map("categoria")
}

model Anuncio {
  id          Int      @id @default(autoincrement())
  titulo      String   @db.VarChar(150)
  descricao   String   @db.VarChar(2000)
  preco       Decimal  @db.Decimal(10, 2) 
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  usuarioId   Int
  usuario     Usuario  @relation(fields: [usuarioId], references: [id])
  
  categoriaId Int
  categoria   Categoria @relation(fields: [categoriaId], references: [id])

  imagens     Imagens[]

  @@map("anuncio")
}

enum TipoAnuncio{
  PRODUTO
  SERVICO
}

model Imagens{
  id              Int      @id @default(autoincrement())
  createdAt       DateTime @default(now())
  url             String @db.Text

  anuncioId       Int
  anuncio         Anuncio  @relation(fields: [anuncioId], references: [id], onDelete: Cascade)

  @@map("imagens")
}